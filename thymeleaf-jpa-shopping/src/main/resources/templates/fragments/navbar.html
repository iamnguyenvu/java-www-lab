<nav th:fragment="navbar" class="app-nav" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
    <div class="app-nav__wrap">
        <div style="display:flex; align-items:center; gap:12px;">
            <label for="nav-toggle" class="nav-burger" aria-label="Toggle navigation">
                <span></span>
                <span></span>
                <span></span>
            </label>
            <a th:href="@{/}" class="nav-brand">
                <span class="nav-pill"></span>
                <span>DearU <span style="color:var(--primary-dark);">Shop</span></span>
            </a>
        </div>

        <input type="checkbox" id="nav-toggle" class="nav-toggle" />

        <div class="app-nav__menu">
            <a class="nav-link"
               th:href="@{/}"
               th:attr="aria-current=${#httpServletRequest != null && #httpServletRequest.requestURI == '/' ? 'page' : null}">Home</a>

            <a class="nav-link"
               th:href="@{/products}"
               th:attr="aria-current=${#httpServletRequest != null && #httpServletRequest.requestURI.startsWith('/products') ? 'page' : null}">Products</a>

            <span sec:authorize="hasAnyRole('ADMIN','CUSTOMER')">
                <a class="nav-link"
                   th:href="@{/orders}"
                   th:attr="aria-current=${#httpServletRequest != null && #httpServletRequest.requestURI.startsWith('/orders') ? 'page' : null}">Orders</a>
            </span>

            <span sec:authorize="hasRole('ADMIN')">
                <a class="nav-link"
                   th:href="@{/customers}"
                   th:attr="aria-current=${#httpServletRequest != null && #httpServletRequest.requestURI.startsWith('/customers') ? 'page' : null}">Customers</a>
            </span>
        </div>

        <div class="app-nav__actions">
            <a th:href="@{/cart}" class="cart-button" aria-label="Giỏ hàng">
                <img th:src="@{/images/cart.png}" alt="Cart icon">
                <span class="cart-badge"
                      th:if="${cartItemCount != null && cartItemCount > 0}"
                      th:text="${cartItemCount}"></span>
            </a>

            <div sec:authorize="isAnonymous()" style="display:flex; gap:10px;">
                <a th:href="@{/login}" class="btn btn-outline">Đăng nhập</a>
                <a th:href="@{/register}" class="btn btn-primary">Đăng ký</a>
            </div>

            <div sec:authorize="isAuthenticated()" style="display:flex; align-items:center; gap:12px;">
                <span style="color:var(--muted); font-size:14px;">Xin chào, <strong sec:authentication="name"></strong></span>
                <form th:action="@{/logout}" method="post" style="margin:0;">
                    <button type="submit" class="btn btn-ghost">Đăng xuất</button>
                </form>
            </div>
        </div>
    </div>
</nav>
